security {
  jwtSecret = "test_secret_change_me"
  issuer   = "newsbot-test"
  audience = "newsbot-clients-test"
  realm    = "newsbot-api-test"
  accessTtlMinutes = 5
  webappTtlMinutes = 15
}

telegram {
  botToken = "123456789:TEST_TOKEN"
  webhookSecret = "integration-secret"
}

webhook {
  queue {
    capacity = 3
    workers = 1
    overflow = "drop_latest"
  }
}

upload {
  csvMaxBytes = 262144
  allowedCsvContentTypes = ["text/csv","application/octet-stream"]
}

portfolio { defaultValuationMethod = "AVERAGE", autoCreateInstruments = true }
pricing   { preferClosePrice = true, fallbackToLast = true }

billing { defaultDurationDays = 7 }

privacy {
  retention {
    analyticsDays = 90
    alertsDays = 30
    botStartsDays = 30
  }
  erasure {
    enabled = false
    dryRun = true
    batchSize = 1000
  }
}

integrations {
  userAgent = "newsbot-test"
  http {
    timeoutMs {
      connect = 1000
      socket = 1000
      request = 1000
    }
    retry {
      maxAttempts = 1
      baseBackoffMs = 1
      jitterMs = 0
      respectRetryAfter = false
      retryOn = []
    }
    circuitBreaker {
      failuresThreshold = 3
      windowSeconds = 60
      openSeconds = 10
      halfOpenMaxCalls = 1
    }
  }
  moex { }
  coingecko { }
  cbr { }
  netflow2 { }
  mtproto {
    enabled = false
    baseUrl = "http://mtproto-gateway"
    apiKey = "test-key"
  }
}

performance {
  httpClient {
    maxConnectionsPerRoute = 4
    keepAliveSeconds = 30
  }
  cacheTtlMs {
    moex = 1000
    coingecko = 1000
    cbr = 1000
  }
}
